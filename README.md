Published as written during the contest, with no modifications.

Code's bad, I know.
